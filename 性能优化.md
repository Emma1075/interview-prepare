# 性能优化

## 1. 网络相关性能优化
1. DNS 预解析
DNS 解析也是需要时间的，可以通过预解析的方式来预先获得域名所对应的 IP。

```html
<link rel="dns-prefetch" href="//yuchengkai.cn" />

```

2. 缓存
强缓存、协商缓存

3. 使用 HTTP / 2.0

多路复用，Header 压缩

4. 预加载

```html
<link rel="preload" href="http://example.com" />

```

预加载可以一定程度上降低首屏的加载时间，因为可以将一些不影响首屏但重要的文件延后加载，唯一缺点就是兼容性不好


5. 预渲染

可以通过预渲染将下载的文件预先在后台渲染，可以使用以下代码开启预渲染

要确保该页面百分百会被用户在之后打开，否则就白白浪费资源去渲染

```html

<link rel="prerender" href="http://example.com" />
```

## 2. 渲染过程


1. 懒执行

某些逻辑延迟到使用时再计算

可以用于首屏优化，对于某些耗时逻辑并不需要在首屏就使用的，就可以使用懒执行。
懒执行需要唤醒，一般可以通过定时器或者事件的调用来唤醒。

2. 懒加载

不关键的资源延后加载

懒加载不仅可以用于图片，也可以使用在别的资源上。比如进入可视区域才开始播放视频等等。



## 3. 文件优化

1. 图片优化
  - 不用图
  - base64
  - cdn
  - 雪碧图
  - 正确格式(webp格式、png、svg、jpeg)

2. 其他文件优化
  - css 放 head中
  - server 开启文件压缩
  - script 放body 底部
  - webworker  （开启新线程执行code不影响渲染）

3. cdn
  - 浏览器对单个域名有并发请求上限，故可用多个cdn域名


## 4. webpack优化
1. es6模块开启 tree shaking（移除无使用代码）
2. base64图片
3. 按需加载，按路由拆包
4. 文件名加hash，浏览器缓存